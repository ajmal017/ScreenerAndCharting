<!DOCTYPE html>
<html>
<body style="background-color:powderblue;">

<style>
body {
	background-image:url(img src="img/background.png")
}
</style>
<p style="font-size:150%;" id="messageLink"></p>
<p style="font-size:150%;"> Enter Stock Tickers :</p>
<input type="text" id="stockTicker">
<button type="button" onclick="mainFunction()">Open ChartInk links</button>
<button type="button" onclick="startOverFunction()">Start Over</button>
<p style="font-size:150%;"> Number of charts to open per click :</p>
<input type="text" id="stockToDisplay" spellcheck="false">
<p id="messageProcessedStocks"></p>
<p id="messageProcessedStocksStats"></p>

<center> <img src="img/background.png" alt="Mountain View" > </center>

<script>
var messageLink = document.getElementById("messageLink");
messageLink.innerHTML = "Copy data from: https://www.nseindia.com/products/dynaContent/equities/equities/json/online52NewHigh.json";

totalStocks = 0;
processedStocks = 0;
var x = "";
var messageProcessedStocks = document.getElementById("messageProcessedStocks")
var messageProcessedStocksStats = document.getElementById("messageProcessedStocksStats");
document.getElementById("stockToDisplay").value = 5;

function startOverFunction() {
	
	totalStocks = 0;
	processedStocks = 0;
	messageProcessedStocks.innerHTML = "";
	messageProcessedStocksStats.innerHTML = "Total stocks: " + totalStocks + " Processed: " + processedStocks
}

function openPage(stock){

	var text = "http://chartink.com/stocks/" + stock + ".html";
	text = text.replace (/"/g,"");
	text = text.replace (/ /g,"");
	console.log(text);
	window.open(text);
}

function mainFunction() {
	var stocks_list = document.getElementById("stockTicker").value;
	var newObj = JSON.parse(stocks_list);	
	var stocksToDisplay = document.getElementById("stockToDisplay").value;
	messageProcessedStocks.innerHTML = x;
	totalStocks = newObj.data.length	

	debugger;
	for (i = processedStocks ; i < totalStocks ; i++) {
		debugger;
		x += newObj.data[i].symbol;
		x += ", ";
		messageProcessedStocks.innerHTML = x;
		openPage(newObj.data[i].symbol)
		debugger;
		processedStocks += 1
		if (processedStocks % stocksToDisplay == 0)
			break;
	}
	messageProcessedStocksStats.innerHTML = "Total stocks: " + totalStocks + " Processed: " + processedStocks
}
</script>
</body>
</html>
